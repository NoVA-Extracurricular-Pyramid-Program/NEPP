<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Resources - NEPP</title>
    <link rel="icon" href="../images/logo.png" type="image/png">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/resources.css">
</head>
<body>
    <div id="settings-container"></div>
    <div class="nepp-root">
        <aside class="sidebar">
            <!-- Sidebar content will be loaded here by sidebar.js -->
        </aside>
        <main class="main-content">
            <div class="resources-header">
                <h1>Resources</h1>
                <div class="resources-controls">
                    <div class="filter-container">
                        <select id="fileFilter" class="filter-select">
                            <option value="all">All Files</option>
                            <option value="my-files">My Files</option>
                            <option value="shared-with-me">Shared with Me</option>
                            <option value="shared-by-me">Shared by Me</option>
                        </select>
                    </div>
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Search files and folders..." class="search-input">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                        </svg>
                    </div>
                    <button id="createFolderBtn" class="create-folder-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" />
                        </svg>
                        New Folder
                    </button>
                    <button id="uploadBtn" class="upload-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
                        </svg>
                        Upload Files
                    </button>
                </div>
            </div>

            <!-- Breadcrumb Navigation -->
            <div class="breadcrumb-container">
                <nav class="breadcrumb-nav">
                    <ol id="breadcrumbList" class="breadcrumb-list">
                        <li class="breadcrumb-item">
                            <button id="rootFolder" class="breadcrumb-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                                </svg>
                                My Resources
                            </button>
                        </li>
                    </ol>
                </nav>
            </div>
            
            <div class="resources-container">
                <div id="dropZone" class="drop-zone">
                    <div class="drop-zone-content">
                        <svg class="drop-zone-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
                        </svg>
                        <h3>Drag & Drop Files Here</h3>
                        <p>or click to select files from your computer</p>
                    </div>
                </div>
                
                <div id="filesContainer" class="files-container">
                    <div id="filesList" class="files-list">
                        <!-- Files and folders will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Upload Progress Modal -->
            <div id="uploadModal" class="modal upload-modal" style="display: none;">
                <div class="modal-content">
                    <h3>Uploading Files</h3>
                    <div id="uploadProgress" class="upload-progress">
                        <!-- Progress bars will be added here -->
                    </div>
                    <button id="cancelUpload" class="cancel-btn">Cancel</button>
                </div>
            </div>

            <!-- Create Folder Modal -->
            <div id="createFolderModal" class="modal create-folder-modal" style="display: none;">
                <div class="modal-content">
                    <h3>Create New Folder</h3>
                    <div class="form-group">
                        <label for="folderName">Folder Name:</label>
                        <input type="text" id="folderName" class="form-input" placeholder="Enter folder name..." maxlength="100" />
                    </div>
                    <div class="modal-actions">
                        <button id="cancelCreateFolder" class="cancel-btn">Cancel</button>
                        <button id="confirmCreateFolder" class="submit-btn">Create Folder</button>
                    </div>
                </div>
            </div>

            <!-- Rename Modal -->
            <div id="renameModal" class="modal rename-modal" style="display: none;">
                <div class="modal-content">
                    <h3 id="renameModalTitle">Rename Item</h3>
                    <div class="form-group">
                        <label for="newItemName">New Name:</label>
                        <input type="text" id="newItemName" class="form-input" placeholder="Enter new name..." maxlength="100" />
                    </div>
                    <div class="modal-actions">
                        <button id="cancelRename" class="cancel-btn">Cancel</button>
                        <button id="confirmRename" class="submit-btn">Rename</button>
                    </div>
                </div>
            </div>

            <!-- Move Modal -->
            <div id="moveModal" class="modal move-modal" style="display: none;">
                <div class="modal-content">
                    <h3 id="moveModalTitle">Move Item</h3>
                    <div class="form-group">
                        <label for="targetFolder">Select Destination Folder:</label>
                        <div id="folderTree" class="folder-tree">
                            <!-- Folder tree will be populated here -->
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button id="cancelMove" class="cancel-btn">Cancel</button>
                        <button id="confirmMove" class="submit-btn">Move Here</button>
                    </div>
                </div>
            </div>

            <!-- File Sharing Options Modal -->
            <div id="shareModal" class="modal share-modal" style="display: none;">
                <div class="modal-content">
                    <h3>Share Files</h3>
                    <div class="share-options">
                        <div class="form-group">
                            <label for="shareType">Share with:</label>
                            <select id="shareType" class="form-select">
                                <option value="private">Only me (Private)</option>
                                <option value="group">Group members</option>
                                <option value="specific">Specific users</option>
                            </select>
                        </div>
                        
                        <div id="groupSelection" class="form-group" style="display: none;">
                            <label for="groupSelect">Select Group:</label>
                            <select id="groupSelect" class="form-select">
                                <!-- Groups will be loaded here -->
                            </select>
                        </div>
                        
                        <div id="userSelection" class="form-group" style="display: none;">
                            <label for="userSelect">Select Users:</label>
                            <div id="userSelect" class="user-select-container">
                                <!-- Users will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="shareDescription">Description (optional):</label>
                            <textarea id="shareDescription" rows="3" placeholder="Add a description for these files..."></textarea>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button id="cancelShare" class="cancel-btn">Cancel</button>
                        <button id="confirmShare" class="submit-btn">Share Files</button>
                    </div>
                </div>
            </div>
            
            <!-- File Preview Modal -->
            <div id="previewModal" class="modal preview-modal" style="display: none;">
                <div class="modal-content preview-content">
                    <button class="close-btn" id="closePreview">&times;</button>
                    <div id="previewContainer">
                        <!-- File preview will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Context Menu -->
            <div id="contextMenu" class="context-menu" style="display: none;">
                <div class="context-menu-item" id="contextRename">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                    </svg>
                    Rename
                </div>
                <div class="context-menu-item" id="contextMove">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" />
                    </svg>
                    Move
                </div>
                <div class="context-menu-item" id="contextShare">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314a2.25 2.25 0 1 1 .434 2.44L7.217 13.747m0-2.186 9.566 5.314m-9.566-5.314L7.217 13.747M10.5 12a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
                    </svg>
                    Share
                </div>
                <div class="context-menu-divider"></div>
                <div class="context-menu-item context-menu-danger" id="contextDelete">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                    </svg>
                    Delete
                </div>
            </div>
        </main>
    </div>
    
    <input type="file" id="fileInput" multiple style="display: none;">
    
    <script type="module" src="/config/firebase-config.js"></script>
    <script type="module" src="/components/sidebar.js"></script>
    <script type="module" src="/services/auth-service.js"></script>
    <script type="module" src="/services/resources-service.js"></script>
    <script type="module" src="../js/resources.js"></script>
</body>
</html>
